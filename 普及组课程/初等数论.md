# 初等数论

## 整数的基本性质

设a,b是两个整数，其中b != 0。如果存在一个整数q使得等式 a = bq成立，就称b整除a或者a被b整除记作b|a，并把b叫作a的因数，把a叫作b的倍数。这时，q也是a的因数，我们常常将q写成a / b; 
在C++中用 a % b == 0表示整除

整除的一些常用结论:

1. 当b遍历整数a的所有因数时，-b也遍历也遍历整数a的所有因数

2. 当b遍历整数a的所有因数时，a/b也遍历整数a的所有因数
   所以对于此来说 1~sqrt(a)的因子和sqrt(a) + 1 ~ a的因子一一对应
   所以我们求数a的因子有哪些的代码通常这样写

   ```
   for(int i = 2; i * i <= a; i++){
   	if(a % i != 0) continue;
   	if(i * i == a) b[++cnt] = i;
   	else b[++cnt] = i,b[++cnt] = a / i;
   }
   ```

3. 设b，c都是非零整数

   1. 若b | a，则 |b| | |a|
   2. 若 b | a，则 bc | ac
   3. 若 b | a，则 1< |b| <= |a|
   4. 若 b | a，a | c 那么 b | c
   5. 若 b | a，b | c 那么任意 整数x，y使得 b | ax + cy
   6. 设 a != 0,b = qa + c 那么 a | b $\Longleftrightarrow$ a| c

------

### **练习：**

​	1.苹果丰收，得到了120个苹果，恰好平分给x个小朋友（每个小朋友拿到的苹果数量一样) 请问，x能取那些值





​	2.找循环节。给定一个长度为n的字符串，求它的最小循环节长度，n <= 10^5^。例如输入 "abbaabbaabba" 输出4





​	3.洛谷P2926。给定n和n个正整，求每个数是另外多少个数的倍数，n <= 10^5^，其他数字a~i~不超过 10^6^。例如给出5个数，分别是2，1，2，3，4。答案输出 2，0，2，1，3





​	4.洛谷P1403

![image-20220923152838729](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\image-20220923152838729.png)

N <= 10^6^



















**拓展:**

![image-20220923152838729](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\image-20220923152838729.png)

N <= 10^9^





























洛谷P2424

![image-20220923155352591](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\image-20220923155352591.png)




X,Y <= 10^9^



------

# 素数

**设n为一个正整数且n != 1，倘若n的因子只有自己本身和1的话他就是个素数(又称质数，不可约数)，其他的数称为合数**

**特殊的 0，1既不是质数也不是合数，所以最小的质数是2，最小的合数是4**

**规定:若没有特殊说明，素数一般指正整数，用p~1~,p~2~.....p~n~表示**

p 和 -p总是同为素数或者同为合数。**如果没有特别说明，素数总是指正的素数。**

整数的因数是素数，则该素数称为该整数的素因数（素约数）。

素数与合数的简单性质：

- 大于1的整数a是合数，等价于a可以表示为整数d 和e（1<d,e<a）的乘积。
- 如果素数p有大于1的约数 d，那么 d = p 。
- 大于1的整数a一定可以表示为素数的乘积。
- 对于合数a，一定存在素数 p <= $\sqrt{a}$使得  p | a。
- 素数有无穷多个。
- 所有大于3的素数都可以表示为6n士1 的形式。
  证明:当n表示自然数的时候，用6n、6n+1、6n+2、6n+3、6n+4、6n+5就可以表示所有的自然数。其中，6n是6的倍数，一定不是质数；
  6n+2是偶数，只有n=0时，6n+2=2是质数；
  6n+3是3的倍数，只有n=0时，6n+3=3是质数；
  6n+4是偶数，并且大于2，一定不是质数；
  所以，在n＞0的情况下，只有6n+1和6n+5才可能是质数。
  而6n+5也可以用6n–1表示，如n=1时，6n+5=11；n =2时，6n–1=11。
  这就证明了，大于3质数，都是形如6n+1或6n–1的数。

若gcd(a,b,c,d) = 1 则称 a,b,c,d互素(质数)

### 算术基本定理:任何一个大于1的[自然数](https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/%E8%87%AA%E7%84%B6%E6%95%B0/385394)N,如果N不为**质数**，那么N可以**唯一**分解成有限个质数的乘积.

x = $p_{1}^{a_1}$ * $p_{2}^{a_2}$  * ..... * $p_{n}^{a_n}$ 

#### 存在性证明:

**反证法**

假设存在不能**分解成有限个质数**的乘积的[合数](https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/%E5%90%88%E6%95%B0/49186%3Ffr%3Daladdin)，则其中必有一个**最小**的数（[最小数原理](https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/%E6%9C%80%E5%B0%8F%E6%95%B0%E5%8E%9F%E7%90%86/6062268%3Ffr%3Daladdin)）设为n.

n不是**质数**，所以存在大于1小于n的自然数a,b，使n=ab.

∃a,b∈N∧1<a,b<n⇒n=ab

- 如果a，b都为**质数**，与假设矛盾.
- 如果a，b**至少**有一个是**合数**,因为都比n要小，所以这个合数一定可以被分解成有限个质数的乘积，将乘积替换，可推出n可以分解成有限个质数的乘积，与假设矛盾.

所以原命题成立.

#### 唯一性证明：

**反证法**

[欧几里得引理](https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E5%BC%95%E7%90%86/7642654%3Ffr%3Daladdin)**：**如果 p是素数且p|bc，那么p|b或者p|c.

假设存在某些数，它们有能分解为两种**不同**的质数乘积，将其中**最小**的数设为n

$n=p_1p_2p_3···p_r=q_1q_2q_3···q_s$

因为$p_1 可以除以 (q_1)(q_2q_3···q_s) ,由欧几里得引理得出p_1丨q_1 或者p_1丨q_2q_3···q_s$ （注意这里设的p和q全为**质数**）

所以可以得到 $p_1=q_1 或者 p_1=q_i$(2≤i≤s,i∈k)

上面任意一种情况，等可以将原式子左右两边同时**消掉**一个数，这样就得到了一个**更小的数**能表示两种质数乘积，与**n是最小数**的假设矛盾，唯一性得证.

### 练习:

1. 给定 n 个正整数 a~i~，判定每个数是否是质数。 n <= 100, a~i~ <= 1e9

   

   

2. 给定 n 个正整数 a~i~，将每个数分解质因数，并按照质因数从小到大的顺序输出每个质因数的底数和指数。 n <= 100, a~i~ <= 1e9

   

   

3. 洛谷U248208给定一个正整数 n，请你求出 1∼n 中质数的个数。 n <= 1e6

   

   

4. 给定一个正整数 n，请你求出 1∼n 中质数的个数。 n <= 1e7

   
   
5. ###### U248212哥德巴赫猜想的内容如下：

   任意一个大于 4 的偶数都可以拆成两个奇素数之和。

   例如：

   8=3+5

   20=3+17=7+13

   42=5+37=11+31=13+29=19+23

   现在，你的任务是验证所有小于一百万的偶数能否满足哥德巴赫猜想。 n<=1e6

   

   

   

# 余数

![image-20220928142743050](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\image-20220928142743050.png)
**运算取mod：**设$a_1 = b*k_1 + c_1$   $a_2 = b * k_2 + c_2$
$(a_1 + a_2)$  % b$ = $$(c1 + c2) $ % $ b$
$(a_1 $ % b +$ a_2$ % b) % $b$ =  $(c1 + c2) $ % $ b$
所以$(a_1 + a_2) $ % $b$ = $(a_1 $% b + $ a_2$ % b) % $b$
$(a_1$ % $b * a_2$ % b) % b = $(c_1 * c_2)$ % b
$a_1 * a_2$ % b = $ (b^2 * k_1 * k_2 + c_1 * b * k_2 + c_1 * c_2)$ % b = $(c_1 * c_2)$ % b
所以$(a_1$ % $b * a_2$% b) % b = $(c_1 * c_2)$ % b

### 练习:

1. 洛谷U248267 给定两个整数a,b输出$a^1$，$a^2$....，$a^b$，输出可能很大所以答案对于1e9+7取模 a,b <= 10^6^

   

   

# 同余

同余的定义：设整数m≠0。若m | (a - b)，称m为模数（模），a同余于b模m，b是a对模m的剩余。记作 a $\equiv $b(mod m)。
否则，a不同于b模m，b不是a对模m的剩余。
这样的等式，称为模m的同余式，简称同余式。
根据整除的性质， a $\equiv $b(mod -m) **如果没有特别说明模数一般是正整数**
式中的b是a对模m的剩余，这个概念与余数完全一致。通过限定b的范围，相应的有a对模m的最小非负剩余、绝对最小剩余、最小正剩余。

![image-20220927181349482](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\image-20220927181349482.png)


**乘法逆元**: 如果一个线性同余方程ax $\equiv $1(mod b)  ，则称x为a mod b的逆元，记作a^-1^

![image-20220928115506240](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\image-20220928115506240.png)


```
inv[1] = 1;
for (int i = 2; i <= n; ++i) {
  inv[i] = (long long)(p - p / i) * inv[p % i] % p;
}
```



### 练习：

1. 洛谷P3811给定一个数n求解 1 ~ n每个数的逆元，n <= 3e6

   

   

# 约数

其实上边讲整除的时候讲过一部分了，但是这里主要是做练习

### 练习:

1. 洛谷U248278 给定 n 个正整数 $a_i$，请你输出这些数的乘积的约数个数，答案对 10^9^+7取模。

   

   
   
2. 洛谷U248283 给定 n 个正整数 $a_i$，请你输出这些数的乘积的约数之和，答案对 10^9^+7取模。

   

   

   
   

# 最大公约数

如果我们已知两个数a和b，如何求出二者的最大公约数呢？

不妨设 a > b

我们发现如果b是a的约数，那么b就是二者的最大公约数。 下面讨论不能整除的情况，即a = b * q + r ，其中 r < b。

我们通过证明可以得到 gcd(a,b) = gcd(b,a mod b)，过程如下

![image-20220927222221203](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\image-20220927222221203.png)


```
int gcd(int a, int b) { return b == 0 ? a : gcd(b, a % b); }
```

![image-20220928155957614](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\image-20220928155957614.png)


# 最小公倍数

![image-20220928160026725](C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\image-20220928160026725.png)
