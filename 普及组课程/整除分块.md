# 整除分块

### 对于f(i) = 数i的约数个数 求$\sum_{i = 1}^{n} f(i)$来说 如果n很大的话，我们需要一种方法:**整除分块**

| 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 20   | 10   | 6    | 5    | 4    | 3    | 2    | 2    | 2    | 2    | 1    | 1    | 1    | 1    | 1    | 1    | 1    | 1    | 1    | 1    |

#### 通过n=20的表格来说，我们发现对于拥有约数x的个数很大部分是可能重叠的，但是我们并不知道最多有多少个个数

### 集合V的元素个数 = {n | d,d∈1,n}

### 当d <= $\sqrt{n} $的时候最多只有会$ \sqrt{n} $个因子

### 当d > sqrt(n)的时候  $\left \lfloor \frac{n}{d} \right \rfloor  <= \sqrt{n} $

### 所以最多只有 $2*\sqrt{n} $个因子

### 所以倘若我们知道每一段连续区间的 起点和终点的话，我们就可以在 $\sqrt{n} $的复杂度内解决这个问题

### **接下来我们就要解决以下的问题**

###  $\left \lfloor \frac{n}{l} \right \rfloor$ = $| \frac{n}{r}|$ 求 r= l~max~

### 设 k = $\left \lfloor \frac{n}{l} \right \rfloor$ = $\left \lfloor \frac{n}{l + 1} \right \rfloor$ = $\left \lfloor \frac{n}{l + 1} \right \rfloor$ = ....= $\left \lfloor \frac{n}{r} \right \rfloor$ = $\left \lfloor \frac{n}{r + 1} \right \rfloor + 1$

### k <= $ \frac{n}{l}$ < k + 1

###  $ \frac{n}{k}>= l >  \frac{n}{k + 1}$

### 所以  $l<=r <=  \frac{n}{k} = \frac{n}{ \frac{n}{l}} = \frac{n}{\left \lfloor  \frac{n}{l} \right \rfloor} =  \left \lfloor \frac{n}{\left \lfloor \frac{n}{l} \right \rfloor}\right \rfloor$

### **所以我们最后的主要核心式子就是**

```
for(long long l = 1, r; l <= n; l = r + 1){
    r = n / (n / l);
   	res += n / l * (r - l + 1);
}
```





